{% extends "base.html" %}

{% block content %}
<div class="login-container">
    <div class="login-card">
        <div class="login-icon">
            <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                <rect width="48" height="48" rx="8" fill="#3B82F6"/>
                <path d="M24 16V32M16 24H32" stroke="white" stroke-width="2" stroke-linecap="round"/>
                <path d="M16 16L32 32M32 16L16 32" stroke="white" stroke-width="2" stroke-linecap="round"/>
            </svg>
        </div>
        <h1 class="login-title">Request Management System</h1>
        <p class="login-subtitle">Sign in to access your dashboard</p>
        
        <form id="loginForm" class="login-form">
            <div class="form-group">
                <label for="email">Email</label>
                <input type="email" id="email" name="email" placeholder="user@example.com" required>
            </div>
            
            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" name="password" placeholder="Enter your password" required>
            </div>
            
            <button type="submit" class="btn btn-primary btn-block">Sign In</button>
        </form>
        
        <div class="divider">
            <span>QUICK LOGIN (DEMO)</span>
        </div>
        
        <div class="quick-login-grid">
            <a href="{{ url_for('quick_login', role='student') }}" class="quick-login-btn">Student</a>
            <a href="{{ url_for('quick_login', role='secretary') }}" class="quick-login-btn">Secretary</a>
            <a href="{{ url_for('quick_login', role='lecturer') }}" class="quick-login-btn">Lecturer</a>
            <a href="{{ url_for('quick_login', role='head_of_dept') }}" class="quick-login-btn">Head of Dept</a>
        </div>
    </div>
</div>

<script>
document.getElementById('loginForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const email = document.getElementById('email').value;
    const password = document.getElementById('password').value;
    
    try {
        const response = await fetch('{{ url_for("login") }}', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ email, password })
        });
        
        const data = await response.json();
        
        if (data.success) {
            window.location.href = data.redirect || '{{ url_for("dashboard") }}';
        } else {
            alert(data.error || 'Login failed');
        }
    } catch (error) {
        alert('An error occurred. Please try again.');
    }
});
</script>
{% endblock %}
